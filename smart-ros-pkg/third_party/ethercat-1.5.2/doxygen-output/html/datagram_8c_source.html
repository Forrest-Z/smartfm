<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>IgH EtherCAT Master: datagram.c Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>


</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">IgH EtherCAT Master
   &#160;<span id="projectnumber">1.5.2</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('datagram_8c.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">datagram.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="datagram_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/******************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment"> *</span>
<a name="l00003"></a>00003 <span class="comment"> *  $Id: datagram.c,v ec403cf308eb 2013/02/12 14:46:43 fp $</span>
<a name="l00004"></a>00004 <span class="comment"> *</span>
<a name="l00005"></a>00005 <span class="comment"> *  Copyright (C) 2006-2008  Florian Pose, Ingenieurgemeinschaft IgH</span>
<a name="l00006"></a>00006 <span class="comment"> *</span>
<a name="l00007"></a>00007 <span class="comment"> *  This file is part of the IgH EtherCAT Master.</span>
<a name="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009"></a>00009 <span class="comment"> *  The IgH EtherCAT Master is free software; you can redistribute it and/or</span>
<a name="l00010"></a>00010 <span class="comment"> *  modify it under the terms of the GNU General Public License version 2, as</span>
<a name="l00011"></a>00011 <span class="comment"> *  published by the Free Software Foundation.</span>
<a name="l00012"></a>00012 <span class="comment"> *</span>
<a name="l00013"></a>00013 <span class="comment"> *  The IgH EtherCAT Master is distributed in the hope that it will be useful,</span>
<a name="l00014"></a>00014 <span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00015"></a>00015 <span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General</span>
<a name="l00016"></a>00016 <span class="comment"> *  Public License for more details.</span>
<a name="l00017"></a>00017 <span class="comment"> *</span>
<a name="l00018"></a>00018 <span class="comment"> *  You should have received a copy of the GNU General Public License along</span>
<a name="l00019"></a>00019 <span class="comment"> *  with the IgH EtherCAT Master; if not, write to the Free Software</span>
<a name="l00020"></a>00020 <span class="comment"> *  Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA</span>
<a name="l00021"></a>00021 <span class="comment"> *</span>
<a name="l00022"></a>00022 <span class="comment"> *  ---</span>
<a name="l00023"></a>00023 <span class="comment"> *</span>
<a name="l00024"></a>00024 <span class="comment"> *  The license mentioned above concerns the source code only. Using the</span>
<a name="l00025"></a>00025 <span class="comment"> *  EtherCAT technology and brand is only permitted in compliance with the</span>
<a name="l00026"></a>00026 <span class="comment"> *  industrial property and similar rights of Beckhoff Automation GmbH.</span>
<a name="l00027"></a>00027 <span class="comment"> *</span>
<a name="l00028"></a>00028 <span class="comment"> *****************************************************************************/</span>
<a name="l00029"></a>00029 
<a name="l00035"></a>00035 <span class="comment">/*****************************************************************************/</span>
<a name="l00036"></a>00036 
<a name="l00037"></a>00037 <span class="preprocessor">#include &lt;linux/slab.h&gt;</span>
<a name="l00038"></a>00038 
<a name="l00039"></a>00039 <span class="preprocessor">#include &quot;<a class="code" href="datagram_8h.html" title="EtherCAT datagram structure.">datagram.h</a>&quot;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &quot;<a class="code" href="master_8h.html" title="EtherCAT master structure.">master.h</a>&quot;</span>
<a name="l00041"></a>00041 
<a name="l00042"></a>00042 <span class="comment">/*****************************************************************************/</span>
<a name="l00043"></a>00043 
<a name="l00046"></a>00046 <span class="preprocessor">#define EC_FUNC_HEADER \</span>
<a name="l00047"></a>00047 <span class="preprocessor">    ret = ec_datagram_prealloc(datagram, data_size); \</span>
<a name="l00048"></a>00048 <span class="preprocessor">    if (unlikely(ret)) \</span>
<a name="l00049"></a>00049 <span class="preprocessor">        return ret; \</span>
<a name="l00050"></a>00050 <span class="preprocessor">    datagram-&gt;index = 0; \</span>
<a name="l00051"></a>00051 <span class="preprocessor">    datagram-&gt;working_counter = 0; \</span>
<a name="l00052"></a>00052 <span class="preprocessor">    datagram-&gt;state = EC_DATAGRAM_INIT;</span>
<a name="l00053"></a>00053 <span class="preprocessor"></span>
<a name="l00054"></a>00054 <span class="preprocessor">#define EC_FUNC_FOOTER \</span>
<a name="l00055"></a>00055 <span class="preprocessor">    datagram-&gt;data_size = data_size; \</span>
<a name="l00056"></a>00056 <span class="preprocessor">    return 0;</span>
<a name="l00057"></a>00057 <span class="preprocessor"></span>
<a name="l00060"></a>00060 <span class="comment">/*****************************************************************************/</span>
<a name="l00061"></a>00061 
<a name="l00066"></a><a class="code" href="datagram_8c.html#a7e261a85cb515f83efd0be78ca331414">00066</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="datagram_8c.html#a7e261a85cb515f83efd0be78ca331414" title="Array of datagram type strings used in ec_datagram_type_string().">type_strings</a>[] = {
<a name="l00067"></a>00067     <span class="stringliteral">&quot;?&quot;</span>,
<a name="l00068"></a>00068     <span class="stringliteral">&quot;APRD&quot;</span>,
<a name="l00069"></a>00069     <span class="stringliteral">&quot;APWR&quot;</span>,
<a name="l00070"></a>00070     <span class="stringliteral">&quot;APRW&quot;</span>,
<a name="l00071"></a>00071     <span class="stringliteral">&quot;FPRD&quot;</span>,
<a name="l00072"></a>00072     <span class="stringliteral">&quot;FPWR&quot;</span>,
<a name="l00073"></a>00073     <span class="stringliteral">&quot;FPRW&quot;</span>,
<a name="l00074"></a>00074     <span class="stringliteral">&quot;BRD&quot;</span>,
<a name="l00075"></a>00075     <span class="stringliteral">&quot;BWR&quot;</span>,
<a name="l00076"></a>00076     <span class="stringliteral">&quot;BRW&quot;</span>,
<a name="l00077"></a>00077     <span class="stringliteral">&quot;LRD&quot;</span>,
<a name="l00078"></a>00078     <span class="stringliteral">&quot;LWR&quot;</span>,
<a name="l00079"></a>00079     <span class="stringliteral">&quot;LRW&quot;</span>,
<a name="l00080"></a>00080     <span class="stringliteral">&quot;ARMW&quot;</span>,
<a name="l00081"></a>00081     <span class="stringliteral">&quot;FRMW&quot;</span>
<a name="l00082"></a>00082 };
<a name="l00083"></a>00083 
<a name="l00084"></a>00084 <span class="comment">/*****************************************************************************/</span>
<a name="l00085"></a>00085 
<a name="l00088"></a><a class="code" href="datagram_8h.html#a8c149b9109b8710239b65c14bcf87cfd">00088</a> <span class="keywordtype">void</span> <a class="code" href="datagram_8c.html#af3dd26022b8780648d2f96ef558f0657" title="Constructor.">ec_datagram_init</a>(<a class="code" href="structec__datagram__t.html" title="EtherCAT datagram.">ec_datagram_t</a> *datagram )
<a name="l00089"></a>00089 {
<a name="l00090"></a>00090     INIT_LIST_HEAD(&amp;datagram-&gt;<a class="code" href="structec__datagram__t.html#a6e6acbb9301ecc6f382740eae531f00a" title="Master datagram queue item.">queue</a>); <span class="comment">// mark as unqueued</span>
<a name="l00091"></a>00091     datagram-&gt;<a class="code" href="structec__datagram__t.html#a9804c4ebdbd3e7ff5b55bfe3aa33bbef" title="Device via which the datagram shall be / was sent.">device_index</a> = <a class="code" href="globals_8h.html#ad1a2101422888687598d7e1a630c6343a6cc7c24499003f339df547ab73605f13" title="Main device.">EC_DEVICE_MAIN</a>;
<a name="l00092"></a>00092     datagram-&gt;<a class="code" href="structec__datagram__t.html#a5c19753e2f2a239f3496cde3f9c1ee53" title="Datagram type (APRD, BWR, etc.).">type</a> = <a class="code" href="datagram_8h.html#a03209bc3f89797943506f8f7c160b015a455bd48cbb495dc8b0c34ab831a7fb3d" title="Dummy.">EC_DATAGRAM_NONE</a>;
<a name="l00093"></a>00093     memset(datagram-&gt;<a class="code" href="structec__datagram__t.html#acbe5cfc2b01e0ec6cb720b3dc99c4027" title="Recipient address.">address</a>, 0x00, <a class="code" href="globals_8h.html#a636410fd74a8e87229296654da52d250" title="Size of the EtherCAT address field.">EC_ADDR_LEN</a>);
<a name="l00094"></a>00094     datagram-&gt;<a class="code" href="structec__datagram__t.html#ae7471d08444f2bc780532e9268859296" title="Datagram payload.">data</a> = NULL;
<a name="l00095"></a>00095     datagram-&gt;<a class="code" href="structec__datagram__t.html#ae8d52c6dc3ef92d165d9d14cd9c3d593" title="Origin of the data memory.">data_origin</a> = <a class="code" href="globals_8h.html#ab62b6e667f97a3b63d18f8077487d249ab9bbe16f248855308e1ac168fd00a4a4" title="Internal.">EC_ORIG_INTERNAL</a>;
<a name="l00096"></a>00096     datagram-&gt;<a class="code" href="structec__datagram__t.html#a038f0d3706ceb82a71a87644bb5cb987" title="Datagram data memory size.">mem_size</a> = 0;
<a name="l00097"></a>00097     datagram-&gt;<a class="code" href="structec__datagram__t.html#a2bdc1dfd68576466bfe3d276b9322959" title="Size of the data in data.">data_size</a> = 0;
<a name="l00098"></a>00098     datagram-&gt;<a class="code" href="structec__datagram__t.html#a76cb4206efa88c4084db0b99c802d5b9" title="Index (set by master).">index</a> = 0x00;
<a name="l00099"></a>00099     datagram-&gt;<a class="code" href="structec__datagram__t.html#a1eeebb1d33d0dbf47498dd78a966977d" title="Working counter.">working_counter</a> = 0x0000;
<a name="l00100"></a>00100     datagram-&gt;<a class="code" href="structec__datagram__t.html#a90d55e568be4b8464e9725c105d6c4b0" title="State.">state</a> = <a class="code" href="datagram_8h.html#ac9882419ec1404dcca75761c4d1ce720a5ccc352710bfd57969fdba9a13f91f71" title="Initial state of a new datagram.">EC_DATAGRAM_INIT</a>;
<a name="l00101"></a>00101 <span class="preprocessor">#ifdef EC_HAVE_CYCLES</span>
<a name="l00102"></a>00102 <span class="preprocessor"></span>    datagram-&gt;cycles_sent = 0;
<a name="l00103"></a>00103 <span class="preprocessor">#endif</span>
<a name="l00104"></a>00104 <span class="preprocessor"></span>    datagram-&gt;<a class="code" href="structec__datagram__t.html#a640ba704d00d50c33e930b6c641b55d7" title="Jiffies, when the datagram was sent.">jiffies_sent</a> = 0;
<a name="l00105"></a>00105 <span class="preprocessor">#ifdef EC_HAVE_CYCLES</span>
<a name="l00106"></a>00106 <span class="preprocessor"></span>    datagram-&gt;cycles_received = 0;
<a name="l00107"></a>00107 <span class="preprocessor">#endif</span>
<a name="l00108"></a>00108 <span class="preprocessor"></span>    datagram-&gt;<a class="code" href="structec__datagram__t.html#a3a643445750ee67fa83d182eb720380e" title="Jiffies, when the datagram was received.">jiffies_received</a> = 0;
<a name="l00109"></a>00109     datagram-&gt;<a class="code" href="structec__datagram__t.html#af7007d254b40111c064caaac6f9c4f81" title="Number of requeues when not yet received.">skip_count</a> = 0;
<a name="l00110"></a>00110     datagram-&gt;<a class="code" href="structec__datagram__t.html#a9a6c9216d340b19a47e802ce89fbb269" title="Last statistics output.">stats_output_jiffies</a> = 0;
<a name="l00111"></a>00111     memset(datagram-&gt;<a class="code" href="structec__datagram__t.html#af2690854e7fb1c410aa37a1ed225836d" title="Description of the datagram.">name</a>, 0x00, <a class="code" href="globals_8h.html#ac67cff75d900b9f1112a4c1a635e495d" title="Size of the datagram description string.">EC_DATAGRAM_NAME_SIZE</a>);
<a name="l00112"></a>00112 }
<a name="l00113"></a>00113 
<a name="l00114"></a>00114 <span class="comment">/*****************************************************************************/</span>
<a name="l00115"></a>00115 
<a name="l00118"></a><a class="code" href="datagram_8h.html#abb57d145234f12a354a0286dab86f106">00118</a> <span class="keywordtype">void</span> <a class="code" href="datagram_8c.html#ac4bb8c0e9a5ac20a8d2c31f34a7fc4a9" title="Destructor.">ec_datagram_clear</a>(<a class="code" href="structec__datagram__t.html" title="EtherCAT datagram.">ec_datagram_t</a> *datagram )
<a name="l00119"></a>00119 {
<a name="l00120"></a>00120     <a class="code" href="datagram_8c.html#aee6dc6380ce5925e75a07cc8d618ca8e" title="Unqueue datagram.">ec_datagram_unqueue</a>(datagram);
<a name="l00121"></a>00121 
<a name="l00122"></a>00122     <span class="keywordflow">if</span> (datagram-&gt;<a class="code" href="structec__datagram__t.html#ae8d52c6dc3ef92d165d9d14cd9c3d593" title="Origin of the data memory.">data_origin</a> == <a class="code" href="globals_8h.html#ab62b6e667f97a3b63d18f8077487d249ab9bbe16f248855308e1ac168fd00a4a4" title="Internal.">EC_ORIG_INTERNAL</a> &amp;&amp; datagram-&gt;<a class="code" href="structec__datagram__t.html#ae7471d08444f2bc780532e9268859296" title="Datagram payload.">data</a>) {
<a name="l00123"></a>00123         kfree(datagram-&gt;<a class="code" href="structec__datagram__t.html#ae7471d08444f2bc780532e9268859296" title="Datagram payload.">data</a>);
<a name="l00124"></a>00124         datagram-&gt;<a class="code" href="structec__datagram__t.html#ae7471d08444f2bc780532e9268859296" title="Datagram payload.">data</a> = NULL;
<a name="l00125"></a>00125     }
<a name="l00126"></a>00126 }
<a name="l00127"></a>00127 
<a name="l00128"></a>00128 <span class="comment">/*****************************************************************************/</span>
<a name="l00129"></a>00129 
<a name="l00132"></a><a class="code" href="datagram_8h.html#a43d78d0e9873569e4b5c840fafdadba5">00132</a> <span class="keywordtype">void</span> <a class="code" href="datagram_8c.html#aee6dc6380ce5925e75a07cc8d618ca8e" title="Unqueue datagram.">ec_datagram_unqueue</a>(<a class="code" href="structec__datagram__t.html" title="EtherCAT datagram.">ec_datagram_t</a> *datagram )
<a name="l00133"></a>00133 {
<a name="l00134"></a>00134     <span class="keywordflow">if</span> (!list_empty(&amp;datagram-&gt;<a class="code" href="structec__datagram__t.html#a6e6acbb9301ecc6f382740eae531f00a" title="Master datagram queue item.">queue</a>)) {
<a name="l00135"></a>00135         list_del_init(&amp;datagram-&gt;<a class="code" href="structec__datagram__t.html#a6e6acbb9301ecc6f382740eae531f00a" title="Master datagram queue item.">queue</a>);
<a name="l00136"></a>00136     }
<a name="l00137"></a>00137 }
<a name="l00138"></a>00138 
<a name="l00139"></a>00139 <span class="comment">/*****************************************************************************/</span>
<a name="l00140"></a>00140 
<a name="l00150"></a><a class="code" href="datagram_8h.html#a92a101b920c6e3cedd187a74d148c65c">00150</a> <span class="keywordtype">int</span> <a class="code" href="datagram_8c.html#a407dc1f0c4247f84e4193b4368be8a8b" title="Allocates internal payload memory.">ec_datagram_prealloc</a>(
<a name="l00151"></a>00151         <a class="code" href="structec__datagram__t.html" title="EtherCAT datagram.">ec_datagram_t</a> *datagram, 
<a name="l00152"></a>00152         <span class="keywordtype">size_t</span> size 
<a name="l00153"></a>00153         )
<a name="l00154"></a>00154 {
<a name="l00155"></a>00155     <span class="keywordflow">if</span> (datagram-&gt;<a class="code" href="structec__datagram__t.html#ae8d52c6dc3ef92d165d9d14cd9c3d593" title="Origin of the data memory.">data_origin</a> == <a class="code" href="globals_8h.html#ab62b6e667f97a3b63d18f8077487d249a9f7450cec35e7aba63f3de7520f41c4a" title="External.">EC_ORIG_EXTERNAL</a>
<a name="l00156"></a>00156             || size &lt;= datagram-&gt;mem_size)
<a name="l00157"></a>00157         <span class="keywordflow">return</span> 0;
<a name="l00158"></a>00158 
<a name="l00159"></a>00159     <span class="keywordflow">if</span> (datagram-&gt;<a class="code" href="structec__datagram__t.html#ae7471d08444f2bc780532e9268859296" title="Datagram payload.">data</a>) {
<a name="l00160"></a>00160         kfree(datagram-&gt;<a class="code" href="structec__datagram__t.html#ae7471d08444f2bc780532e9268859296" title="Datagram payload.">data</a>);
<a name="l00161"></a>00161         datagram-&gt;<a class="code" href="structec__datagram__t.html#ae7471d08444f2bc780532e9268859296" title="Datagram payload.">data</a> = NULL;
<a name="l00162"></a>00162         datagram-&gt;<a class="code" href="structec__datagram__t.html#a038f0d3706ceb82a71a87644bb5cb987" title="Datagram data memory size.">mem_size</a> = 0;
<a name="l00163"></a>00163     }
<a name="l00164"></a>00164 
<a name="l00165"></a>00165     <span class="keywordflow">if</span> (!(datagram-&gt;<a class="code" href="structec__datagram__t.html#ae7471d08444f2bc780532e9268859296" title="Datagram payload.">data</a> = kmalloc(size, GFP_KERNEL))) {
<a name="l00166"></a>00166         <a class="code" href="globals_8h.html#aed23297031f2f23bb5d005bb586790cf" title="Convenience macro for printing EtherCAT-specific errors to syslog.">EC_ERR</a>(<span class="stringliteral">&quot;Failed to allocate %zu bytes of datagram memory!\n&quot;</span>, size);
<a name="l00167"></a>00167         <span class="keywordflow">return</span> -ENOMEM;
<a name="l00168"></a>00168     }
<a name="l00169"></a>00169 
<a name="l00170"></a>00170     datagram-&gt;<a class="code" href="structec__datagram__t.html#a038f0d3706ceb82a71a87644bb5cb987" title="Datagram data memory size.">mem_size</a> = size;
<a name="l00171"></a>00171     <span class="keywordflow">return</span> 0;
<a name="l00172"></a>00172 }
<a name="l00173"></a>00173 
<a name="l00174"></a>00174 <span class="comment">/*****************************************************************************/</span>
<a name="l00175"></a>00175 
<a name="l00178"></a><a class="code" href="datagram_8h.html#ae3a997439eaf8c94e0272e309f06da94">00178</a> <span class="keywordtype">void</span> <a class="code" href="datagram_8c.html#a56f873f563806b58344e8d5da6b0a53d" title="Fills the datagram payload memory with zeros.">ec_datagram_zero</a>(<a class="code" href="structec__datagram__t.html" title="EtherCAT datagram.">ec_datagram_t</a> *datagram )
<a name="l00179"></a>00179 {
<a name="l00180"></a>00180     memset(datagram-&gt;<a class="code" href="structec__datagram__t.html#ae7471d08444f2bc780532e9268859296" title="Datagram payload.">data</a>, 0x00, datagram-&gt;<a class="code" href="structec__datagram__t.html#a2bdc1dfd68576466bfe3d276b9322959" title="Size of the data in data.">data_size</a>);
<a name="l00181"></a>00181 }
<a name="l00182"></a>00182 
<a name="l00183"></a>00183 <span class="comment">/*****************************************************************************/</span>
<a name="l00184"></a>00184 
<a name="l00189"></a><a class="code" href="datagram_8h.html#a28104e7c3691ae038472f292d77f0e1c">00189</a> <span class="keywordtype">int</span> <a class="code" href="datagram_8c.html#aecab9ec4564cb288038b4adecbf27633" title="Initializes an EtherCAT APRD datagram.">ec_datagram_aprd</a>(
<a name="l00190"></a>00190         <a class="code" href="structec__datagram__t.html" title="EtherCAT datagram.">ec_datagram_t</a> *datagram, 
<a name="l00191"></a>00191         uint16_t ring_position, 
<a name="l00192"></a>00192         uint16_t mem_address, 
<a name="l00193"></a>00193         <span class="keywordtype">size_t</span> data_size 
<a name="l00194"></a>00194         )
<a name="l00195"></a>00195 {
<a name="l00196"></a>00196     <span class="keywordtype">int</span> ret;
<a name="l00197"></a>00197     EC_FUNC_HEADER;
<a name="l00198"></a>00198     datagram-&gt;<a class="code" href="structec__datagram__t.html#a5c19753e2f2a239f3496cde3f9c1ee53" title="Datagram type (APRD, BWR, etc.).">type</a> = <a class="code" href="datagram_8h.html#a03209bc3f89797943506f8f7c160b015a4f04360dcb5d54e7fa9cc9d29b0201d4" title="Auto Increment Physical Read.">EC_DATAGRAM_APRD</a>;
<a name="l00199"></a>00199     <a class="code" href="group__ApplicationInterface.html#gaef851d843ec4ba3fd6109185d56946fc" title="Write a 16-bit signed value to EtherCAT data.">EC_WRITE_S16</a>(datagram-&gt;<a class="code" href="structec__datagram__t.html#acbe5cfc2b01e0ec6cb720b3dc99c4027" title="Recipient address.">address</a>, (int16_t) ring_position * (-1));
<a name="l00200"></a>00200     <a class="code" href="group__ApplicationInterface.html#gace219530ddd83f5f3f54d5b329b94a3d" title="Write a 16-bit unsigned value to EtherCAT data.">EC_WRITE_U16</a>(datagram-&gt;<a class="code" href="structec__datagram__t.html#acbe5cfc2b01e0ec6cb720b3dc99c4027" title="Recipient address.">address</a> + 2, mem_address);
<a name="l00201"></a>00201     EC_FUNC_FOOTER;
<a name="l00202"></a>00202 }
<a name="l00203"></a>00203 
<a name="l00204"></a>00204 <span class="comment">/*****************************************************************************/</span>
<a name="l00205"></a>00205 
<a name="l00210"></a><a class="code" href="datagram_8h.html#ab1f9df4ca5a9b197bbebab97c3b1b014">00210</a> <span class="keywordtype">int</span> <a class="code" href="datagram_8c.html#a5df5ebc6c2da74508f66a0ccc7313dcc" title="Initializes an EtherCAT APWR datagram.">ec_datagram_apwr</a>(
<a name="l00211"></a>00211         <a class="code" href="structec__datagram__t.html" title="EtherCAT datagram.">ec_datagram_t</a> *datagram, 
<a name="l00212"></a>00212         uint16_t ring_position, 
<a name="l00213"></a>00213         uint16_t mem_address, 
<a name="l00214"></a>00214         <span class="keywordtype">size_t</span> data_size 
<a name="l00215"></a>00215         )
<a name="l00216"></a>00216 {
<a name="l00217"></a>00217     <span class="keywordtype">int</span> ret;
<a name="l00218"></a>00218     EC_FUNC_HEADER;
<a name="l00219"></a>00219     datagram-&gt;<a class="code" href="structec__datagram__t.html#a5c19753e2f2a239f3496cde3f9c1ee53" title="Datagram type (APRD, BWR, etc.).">type</a> = <a class="code" href="datagram_8h.html#a03209bc3f89797943506f8f7c160b015adde6a3abb46fc29cf612209f80961ffa" title="Auto Increment Physical Write.">EC_DATAGRAM_APWR</a>;
<a name="l00220"></a>00220     <a class="code" href="group__ApplicationInterface.html#gaef851d843ec4ba3fd6109185d56946fc" title="Write a 16-bit signed value to EtherCAT data.">EC_WRITE_S16</a>(datagram-&gt;<a class="code" href="structec__datagram__t.html#acbe5cfc2b01e0ec6cb720b3dc99c4027" title="Recipient address.">address</a>, (int16_t) ring_position * (-1));
<a name="l00221"></a>00221     <a class="code" href="group__ApplicationInterface.html#gace219530ddd83f5f3f54d5b329b94a3d" title="Write a 16-bit unsigned value to EtherCAT data.">EC_WRITE_U16</a>(datagram-&gt;<a class="code" href="structec__datagram__t.html#acbe5cfc2b01e0ec6cb720b3dc99c4027" title="Recipient address.">address</a> + 2, mem_address);
<a name="l00222"></a>00222     EC_FUNC_FOOTER;
<a name="l00223"></a>00223 }
<a name="l00224"></a>00224 
<a name="l00225"></a>00225 <span class="comment">/*****************************************************************************/</span>
<a name="l00226"></a>00226 
<a name="l00231"></a><a class="code" href="datagram_8h.html#a09196132a8e2ba4455e29034c7c1c021">00231</a> <span class="keywordtype">int</span> <a class="code" href="datagram_8c.html#a30163120153779990473e2a7196e4ca6" title="Initializes an EtherCAT APRW datagram.">ec_datagram_aprw</a>(
<a name="l00232"></a>00232         <a class="code" href="structec__datagram__t.html" title="EtherCAT datagram.">ec_datagram_t</a> *datagram, 
<a name="l00233"></a>00233         uint16_t ring_position, 
<a name="l00234"></a>00234         uint16_t mem_address, 
<a name="l00235"></a>00235         <span class="keywordtype">size_t</span> data_size 
<a name="l00236"></a>00236         )
<a name="l00237"></a>00237 {
<a name="l00238"></a>00238     <span class="keywordtype">int</span> ret;
<a name="l00239"></a>00239     EC_FUNC_HEADER;
<a name="l00240"></a>00240     datagram-&gt;<a class="code" href="structec__datagram__t.html#a5c19753e2f2a239f3496cde3f9c1ee53" title="Datagram type (APRD, BWR, etc.).">type</a> = <a class="code" href="datagram_8h.html#a03209bc3f89797943506f8f7c160b015a1c72f47920669e05abafa39e4135aea4" title="Auto Increment Physical ReadWrite.">EC_DATAGRAM_APRW</a>;
<a name="l00241"></a>00241     <a class="code" href="group__ApplicationInterface.html#gaef851d843ec4ba3fd6109185d56946fc" title="Write a 16-bit signed value to EtherCAT data.">EC_WRITE_S16</a>(datagram-&gt;<a class="code" href="structec__datagram__t.html#acbe5cfc2b01e0ec6cb720b3dc99c4027" title="Recipient address.">address</a>, (int16_t) ring_position * (-1));
<a name="l00242"></a>00242     <a class="code" href="group__ApplicationInterface.html#gace219530ddd83f5f3f54d5b329b94a3d" title="Write a 16-bit unsigned value to EtherCAT data.">EC_WRITE_U16</a>(datagram-&gt;<a class="code" href="structec__datagram__t.html#acbe5cfc2b01e0ec6cb720b3dc99c4027" title="Recipient address.">address</a> + 2, mem_address);
<a name="l00243"></a>00243     EC_FUNC_FOOTER;
<a name="l00244"></a>00244 }
<a name="l00245"></a>00245 
<a name="l00246"></a>00246 <span class="comment">/*****************************************************************************/</span>
<a name="l00247"></a>00247 
<a name="l00252"></a><a class="code" href="datagram_8h.html#a9189502fd72cb516ed7e34b717919d11">00252</a> <span class="keywordtype">int</span> <a class="code" href="datagram_8c.html#a9e1bd5b70511e58b0c342fa643ac31e6" title="Initializes an EtherCAT ARMW datagram.">ec_datagram_armw</a>(
<a name="l00253"></a>00253         <a class="code" href="structec__datagram__t.html" title="EtherCAT datagram.">ec_datagram_t</a> *datagram, 
<a name="l00254"></a>00254         uint16_t ring_position, 
<a name="l00255"></a>00255         uint16_t mem_address, 
<a name="l00256"></a>00256         <span class="keywordtype">size_t</span> data_size 
<a name="l00257"></a>00257         )
<a name="l00258"></a>00258 {
<a name="l00259"></a>00259     <span class="keywordtype">int</span> ret;
<a name="l00260"></a>00260     EC_FUNC_HEADER;
<a name="l00261"></a>00261     datagram-&gt;<a class="code" href="structec__datagram__t.html#a5c19753e2f2a239f3496cde3f9c1ee53" title="Datagram type (APRD, BWR, etc.).">type</a> = <a class="code" href="datagram_8h.html#a03209bc3f89797943506f8f7c160b015a3480b2f60d4ee7fafd94582afd4a82b1" title="Auto Increment Physical Read Multiple Write.">EC_DATAGRAM_ARMW</a>;
<a name="l00262"></a>00262     <a class="code" href="group__ApplicationInterface.html#gaef851d843ec4ba3fd6109185d56946fc" title="Write a 16-bit signed value to EtherCAT data.">EC_WRITE_S16</a>(datagram-&gt;<a class="code" href="structec__datagram__t.html#acbe5cfc2b01e0ec6cb720b3dc99c4027" title="Recipient address.">address</a>, (int16_t) ring_position * (-1));
<a name="l00263"></a>00263     <a class="code" href="group__ApplicationInterface.html#gace219530ddd83f5f3f54d5b329b94a3d" title="Write a 16-bit unsigned value to EtherCAT data.">EC_WRITE_U16</a>(datagram-&gt;<a class="code" href="structec__datagram__t.html#acbe5cfc2b01e0ec6cb720b3dc99c4027" title="Recipient address.">address</a> + 2, mem_address);
<a name="l00264"></a>00264     EC_FUNC_FOOTER;
<a name="l00265"></a>00265 }
<a name="l00266"></a>00266 
<a name="l00267"></a>00267 <span class="comment">/*****************************************************************************/</span>
<a name="l00268"></a>00268 
<a name="l00273"></a><a class="code" href="datagram_8h.html#a0756df47b9ae51ded9a1ca2acc116c93">00273</a> <span class="keywordtype">int</span> <a class="code" href="datagram_8c.html#ae9a50bd9874a22d2f62a17973c042e9b" title="Initializes an EtherCAT FPRD datagram.">ec_datagram_fprd</a>(
<a name="l00274"></a>00274         <a class="code" href="structec__datagram__t.html" title="EtherCAT datagram.">ec_datagram_t</a> *datagram, 
<a name="l00275"></a>00275         uint16_t configured_address, 
<a name="l00276"></a>00276         uint16_t mem_address, 
<a name="l00277"></a>00277         <span class="keywordtype">size_t</span> data_size 
<a name="l00278"></a>00278         )
<a name="l00279"></a>00279 {
<a name="l00280"></a>00280     <span class="keywordtype">int</span> ret;
<a name="l00281"></a>00281 
<a name="l00282"></a>00282     <span class="keywordflow">if</span> (unlikely(configured_address == 0x0000))
<a name="l00283"></a>00283         <a class="code" href="globals_8h.html#a268d5c7947aba061aee9ba26ae5e54cf" title="Convenience macro for printing EtherCAT-specific warnings to syslog.">EC_WARN</a>(<span class="stringliteral">&quot;Using configured station address 0x0000!\n&quot;</span>);
<a name="l00284"></a>00284 
<a name="l00285"></a>00285     EC_FUNC_HEADER;
<a name="l00286"></a>00286     datagram-&gt;<a class="code" href="structec__datagram__t.html#a5c19753e2f2a239f3496cde3f9c1ee53" title="Datagram type (APRD, BWR, etc.).">type</a> = <a class="code" href="datagram_8h.html#a03209bc3f89797943506f8f7c160b015a37da79feb57a32a0d5d009e43e36fc3b" title="Configured Address Physical Read.">EC_DATAGRAM_FPRD</a>;
<a name="l00287"></a>00287     <a class="code" href="group__ApplicationInterface.html#gace219530ddd83f5f3f54d5b329b94a3d" title="Write a 16-bit unsigned value to EtherCAT data.">EC_WRITE_U16</a>(datagram-&gt;<a class="code" href="structec__datagram__t.html#acbe5cfc2b01e0ec6cb720b3dc99c4027" title="Recipient address.">address</a>, configured_address);
<a name="l00288"></a>00288     <a class="code" href="group__ApplicationInterface.html#gace219530ddd83f5f3f54d5b329b94a3d" title="Write a 16-bit unsigned value to EtherCAT data.">EC_WRITE_U16</a>(datagram-&gt;<a class="code" href="structec__datagram__t.html#acbe5cfc2b01e0ec6cb720b3dc99c4027" title="Recipient address.">address</a> + 2, mem_address);
<a name="l00289"></a>00289     EC_FUNC_FOOTER;
<a name="l00290"></a>00290 }
<a name="l00291"></a>00291 
<a name="l00292"></a>00292 <span class="comment">/*****************************************************************************/</span>
<a name="l00293"></a>00293 
<a name="l00298"></a><a class="code" href="datagram_8h.html#a874f9f8511a2a5bb94eea8a168031acd">00298</a> <span class="keywordtype">int</span> <a class="code" href="datagram_8c.html#ad34b69b7bf678ec548bd09d3ec4027d6" title="Initializes an EtherCAT FPWR datagram.">ec_datagram_fpwr</a>(
<a name="l00299"></a>00299         <a class="code" href="structec__datagram__t.html" title="EtherCAT datagram.">ec_datagram_t</a> *datagram, 
<a name="l00300"></a>00300         uint16_t configured_address, 
<a name="l00301"></a>00301         uint16_t mem_address, 
<a name="l00302"></a>00302         <span class="keywordtype">size_t</span> data_size 
<a name="l00303"></a>00303         )
<a name="l00304"></a>00304 {
<a name="l00305"></a>00305     <span class="keywordtype">int</span> ret;
<a name="l00306"></a>00306 
<a name="l00307"></a>00307     <span class="keywordflow">if</span> (unlikely(configured_address == 0x0000))
<a name="l00308"></a>00308         <a class="code" href="globals_8h.html#a268d5c7947aba061aee9ba26ae5e54cf" title="Convenience macro for printing EtherCAT-specific warnings to syslog.">EC_WARN</a>(<span class="stringliteral">&quot;Using configured station address 0x0000!\n&quot;</span>);
<a name="l00309"></a>00309 
<a name="l00310"></a>00310     EC_FUNC_HEADER;
<a name="l00311"></a>00311     datagram-&gt;<a class="code" href="structec__datagram__t.html#a5c19753e2f2a239f3496cde3f9c1ee53" title="Datagram type (APRD, BWR, etc.).">type</a> = <a class="code" href="datagram_8h.html#a03209bc3f89797943506f8f7c160b015a0c3a2341969ba72970430b534ffa7e92" title="Configured Address Physical Write.">EC_DATAGRAM_FPWR</a>;
<a name="l00312"></a>00312     <a class="code" href="group__ApplicationInterface.html#gace219530ddd83f5f3f54d5b329b94a3d" title="Write a 16-bit unsigned value to EtherCAT data.">EC_WRITE_U16</a>(datagram-&gt;<a class="code" href="structec__datagram__t.html#acbe5cfc2b01e0ec6cb720b3dc99c4027" title="Recipient address.">address</a>, configured_address);
<a name="l00313"></a>00313     <a class="code" href="group__ApplicationInterface.html#gace219530ddd83f5f3f54d5b329b94a3d" title="Write a 16-bit unsigned value to EtherCAT data.">EC_WRITE_U16</a>(datagram-&gt;<a class="code" href="structec__datagram__t.html#acbe5cfc2b01e0ec6cb720b3dc99c4027" title="Recipient address.">address</a> + 2, mem_address);
<a name="l00314"></a>00314     EC_FUNC_FOOTER;
<a name="l00315"></a>00315 }
<a name="l00316"></a>00316 
<a name="l00317"></a>00317 <span class="comment">/*****************************************************************************/</span>
<a name="l00318"></a>00318 
<a name="l00323"></a><a class="code" href="datagram_8h.html#a06df15b353aba6fdfe1122e7c95eb19c">00323</a> <span class="keywordtype">int</span> <a class="code" href="datagram_8c.html#a4a60fe5767b94b056fb884c5755ef89e" title="Initializes an EtherCAT FPRW datagram.">ec_datagram_fprw</a>(
<a name="l00324"></a>00324         <a class="code" href="structec__datagram__t.html" title="EtherCAT datagram.">ec_datagram_t</a> *datagram, 
<a name="l00325"></a>00325         uint16_t configured_address, 
<a name="l00326"></a>00326         uint16_t mem_address, 
<a name="l00327"></a>00327         <span class="keywordtype">size_t</span> data_size 
<a name="l00328"></a>00328         )
<a name="l00329"></a>00329 {
<a name="l00330"></a>00330     <span class="keywordtype">int</span> ret;
<a name="l00331"></a>00331 
<a name="l00332"></a>00332     <span class="keywordflow">if</span> (unlikely(configured_address == 0x0000))
<a name="l00333"></a>00333         <a class="code" href="globals_8h.html#a268d5c7947aba061aee9ba26ae5e54cf" title="Convenience macro for printing EtherCAT-specific warnings to syslog.">EC_WARN</a>(<span class="stringliteral">&quot;Using configured station address 0x0000!\n&quot;</span>);
<a name="l00334"></a>00334 
<a name="l00335"></a>00335     EC_FUNC_HEADER;
<a name="l00336"></a>00336     datagram-&gt;<a class="code" href="structec__datagram__t.html#a5c19753e2f2a239f3496cde3f9c1ee53" title="Datagram type (APRD, BWR, etc.).">type</a> = <a class="code" href="datagram_8h.html#a03209bc3f89797943506f8f7c160b015a94bb7b04cafdb9a9b16708830df12420" title="Configured Address Physical ReadWrite.">EC_DATAGRAM_FPRW</a>;
<a name="l00337"></a>00337     <a class="code" href="group__ApplicationInterface.html#gace219530ddd83f5f3f54d5b329b94a3d" title="Write a 16-bit unsigned value to EtherCAT data.">EC_WRITE_U16</a>(datagram-&gt;<a class="code" href="structec__datagram__t.html#acbe5cfc2b01e0ec6cb720b3dc99c4027" title="Recipient address.">address</a>, configured_address);
<a name="l00338"></a>00338     <a class="code" href="group__ApplicationInterface.html#gace219530ddd83f5f3f54d5b329b94a3d" title="Write a 16-bit unsigned value to EtherCAT data.">EC_WRITE_U16</a>(datagram-&gt;<a class="code" href="structec__datagram__t.html#acbe5cfc2b01e0ec6cb720b3dc99c4027" title="Recipient address.">address</a> + 2, mem_address);
<a name="l00339"></a>00339     EC_FUNC_FOOTER;
<a name="l00340"></a>00340 }
<a name="l00341"></a>00341 
<a name="l00342"></a>00342 <span class="comment">/*****************************************************************************/</span>
<a name="l00343"></a>00343 
<a name="l00348"></a><a class="code" href="datagram_8h.html#a2e41788150abc1067d4e4d5db66c2541">00348</a> <span class="keywordtype">int</span> <a class="code" href="datagram_8c.html#a25b7b36ce94f207b4543d8eacdb983d6" title="Initializes an EtherCAT FRMW datagram.">ec_datagram_frmw</a>(
<a name="l00349"></a>00349         <a class="code" href="structec__datagram__t.html" title="EtherCAT datagram.">ec_datagram_t</a> *datagram, 
<a name="l00350"></a>00350         uint16_t configured_address, 
<a name="l00351"></a>00351         uint16_t mem_address, 
<a name="l00352"></a>00352         <span class="keywordtype">size_t</span> data_size 
<a name="l00353"></a>00353         )
<a name="l00354"></a>00354 {
<a name="l00355"></a>00355     <span class="keywordtype">int</span> ret;
<a name="l00356"></a>00356 
<a name="l00357"></a>00357     <span class="keywordflow">if</span> (unlikely(configured_address == 0x0000))
<a name="l00358"></a>00358         <a class="code" href="globals_8h.html#a268d5c7947aba061aee9ba26ae5e54cf" title="Convenience macro for printing EtherCAT-specific warnings to syslog.">EC_WARN</a>(<span class="stringliteral">&quot;Using configured station address 0x0000!\n&quot;</span>);
<a name="l00359"></a>00359 
<a name="l00360"></a>00360     EC_FUNC_HEADER;
<a name="l00361"></a>00361     datagram-&gt;<a class="code" href="structec__datagram__t.html#a5c19753e2f2a239f3496cde3f9c1ee53" title="Datagram type (APRD, BWR, etc.).">type</a> = <a class="code" href="datagram_8h.html#a03209bc3f89797943506f8f7c160b015a924ce1c906dcb8263c6ed75e37bc35db" title="Configured Address Physical Read Multiple Write.">EC_DATAGRAM_FRMW</a>;
<a name="l00362"></a>00362     <a class="code" href="group__ApplicationInterface.html#gace219530ddd83f5f3f54d5b329b94a3d" title="Write a 16-bit unsigned value to EtherCAT data.">EC_WRITE_U16</a>(datagram-&gt;<a class="code" href="structec__datagram__t.html#acbe5cfc2b01e0ec6cb720b3dc99c4027" title="Recipient address.">address</a>, configured_address);
<a name="l00363"></a>00363     <a class="code" href="group__ApplicationInterface.html#gace219530ddd83f5f3f54d5b329b94a3d" title="Write a 16-bit unsigned value to EtherCAT data.">EC_WRITE_U16</a>(datagram-&gt;<a class="code" href="structec__datagram__t.html#acbe5cfc2b01e0ec6cb720b3dc99c4027" title="Recipient address.">address</a> + 2, mem_address);
<a name="l00364"></a>00364     EC_FUNC_FOOTER;
<a name="l00365"></a>00365 }
<a name="l00366"></a>00366 
<a name="l00367"></a>00367 <span class="comment">/*****************************************************************************/</span>
<a name="l00368"></a>00368 
<a name="l00373"></a><a class="code" href="datagram_8h.html#aaf49430ca2c7ac387a389e66172a4228">00373</a> <span class="keywordtype">int</span> <a class="code" href="datagram_8c.html#a69bea0540d9be4f7aceeab708569c945" title="Initializes an EtherCAT BRD datagram.">ec_datagram_brd</a>(
<a name="l00374"></a>00374         <a class="code" href="structec__datagram__t.html" title="EtherCAT datagram.">ec_datagram_t</a> *datagram, 
<a name="l00375"></a>00375         uint16_t mem_address, 
<a name="l00376"></a>00376         <span class="keywordtype">size_t</span> data_size 
<a name="l00377"></a>00377         )
<a name="l00378"></a>00378 {
<a name="l00379"></a>00379     <span class="keywordtype">int</span> ret;
<a name="l00380"></a>00380     EC_FUNC_HEADER;
<a name="l00381"></a>00381     datagram-&gt;<a class="code" href="structec__datagram__t.html#a5c19753e2f2a239f3496cde3f9c1ee53" title="Datagram type (APRD, BWR, etc.).">type</a> = <a class="code" href="datagram_8h.html#a03209bc3f89797943506f8f7c160b015a74127113716bd45eaf6009ecdcb74dfc" title="Broadcast Read.">EC_DATAGRAM_BRD</a>;
<a name="l00382"></a>00382     <a class="code" href="group__ApplicationInterface.html#gace219530ddd83f5f3f54d5b329b94a3d" title="Write a 16-bit unsigned value to EtherCAT data.">EC_WRITE_U16</a>(datagram-&gt;<a class="code" href="structec__datagram__t.html#acbe5cfc2b01e0ec6cb720b3dc99c4027" title="Recipient address.">address</a>, 0x0000);
<a name="l00383"></a>00383     <a class="code" href="group__ApplicationInterface.html#gace219530ddd83f5f3f54d5b329b94a3d" title="Write a 16-bit unsigned value to EtherCAT data.">EC_WRITE_U16</a>(datagram-&gt;<a class="code" href="structec__datagram__t.html#acbe5cfc2b01e0ec6cb720b3dc99c4027" title="Recipient address.">address</a> + 2, mem_address);
<a name="l00384"></a>00384     EC_FUNC_FOOTER;
<a name="l00385"></a>00385 }
<a name="l00386"></a>00386 
<a name="l00387"></a>00387 <span class="comment">/*****************************************************************************/</span>
<a name="l00388"></a>00388 
<a name="l00393"></a><a class="code" href="datagram_8h.html#a0cf08cec8bb44d9f74fd92ded2a217bf">00393</a> <span class="keywordtype">int</span> <a class="code" href="datagram_8c.html#a75d99cd0fb3ed945361b4068c934636f" title="Initializes an EtherCAT BWR datagram.">ec_datagram_bwr</a>(
<a name="l00394"></a>00394         <a class="code" href="structec__datagram__t.html" title="EtherCAT datagram.">ec_datagram_t</a> *datagram, 
<a name="l00395"></a>00395         uint16_t mem_address, 
<a name="l00396"></a>00396         <span class="keywordtype">size_t</span> data_size 
<a name="l00397"></a>00397         )
<a name="l00398"></a>00398 {
<a name="l00399"></a>00399     <span class="keywordtype">int</span> ret;
<a name="l00400"></a>00400     EC_FUNC_HEADER;
<a name="l00401"></a>00401     datagram-&gt;<a class="code" href="structec__datagram__t.html#a5c19753e2f2a239f3496cde3f9c1ee53" title="Datagram type (APRD, BWR, etc.).">type</a> = <a class="code" href="datagram_8h.html#a03209bc3f89797943506f8f7c160b015abe060a204f51ab1ce7d2ff4b8fc4dda0" title="Broadcast Write.">EC_DATAGRAM_BWR</a>;
<a name="l00402"></a>00402     <a class="code" href="group__ApplicationInterface.html#gace219530ddd83f5f3f54d5b329b94a3d" title="Write a 16-bit unsigned value to EtherCAT data.">EC_WRITE_U16</a>(datagram-&gt;<a class="code" href="structec__datagram__t.html#acbe5cfc2b01e0ec6cb720b3dc99c4027" title="Recipient address.">address</a>, 0x0000);
<a name="l00403"></a>00403     <a class="code" href="group__ApplicationInterface.html#gace219530ddd83f5f3f54d5b329b94a3d" title="Write a 16-bit unsigned value to EtherCAT data.">EC_WRITE_U16</a>(datagram-&gt;<a class="code" href="structec__datagram__t.html#acbe5cfc2b01e0ec6cb720b3dc99c4027" title="Recipient address.">address</a> + 2, mem_address);
<a name="l00404"></a>00404     EC_FUNC_FOOTER;
<a name="l00405"></a>00405 }
<a name="l00406"></a>00406 
<a name="l00407"></a>00407 <span class="comment">/*****************************************************************************/</span>
<a name="l00408"></a>00408 
<a name="l00413"></a><a class="code" href="datagram_8h.html#a9f81033d766e9c6e748485defc83a3e9">00413</a> <span class="keywordtype">int</span> <a class="code" href="datagram_8c.html#a1d57600f449a379a24c9c5a8bb7a2e41" title="Initializes an EtherCAT BRW datagram.">ec_datagram_brw</a>(
<a name="l00414"></a>00414         <a class="code" href="structec__datagram__t.html" title="EtherCAT datagram.">ec_datagram_t</a> *datagram, 
<a name="l00415"></a>00415         uint16_t mem_address, 
<a name="l00416"></a>00416         <span class="keywordtype">size_t</span> data_size 
<a name="l00417"></a>00417         )
<a name="l00418"></a>00418 {
<a name="l00419"></a>00419     <span class="keywordtype">int</span> ret;
<a name="l00420"></a>00420     EC_FUNC_HEADER;
<a name="l00421"></a>00421     datagram-&gt;<a class="code" href="structec__datagram__t.html#a5c19753e2f2a239f3496cde3f9c1ee53" title="Datagram type (APRD, BWR, etc.).">type</a> = <a class="code" href="datagram_8h.html#a03209bc3f89797943506f8f7c160b015a7e441843805140c02dec287ec8ba0481" title="Broadcast ReadWrite.">EC_DATAGRAM_BRW</a>;
<a name="l00422"></a>00422     <a class="code" href="group__ApplicationInterface.html#gace219530ddd83f5f3f54d5b329b94a3d" title="Write a 16-bit unsigned value to EtherCAT data.">EC_WRITE_U16</a>(datagram-&gt;<a class="code" href="structec__datagram__t.html#acbe5cfc2b01e0ec6cb720b3dc99c4027" title="Recipient address.">address</a>, 0x0000);
<a name="l00423"></a>00423     <a class="code" href="group__ApplicationInterface.html#gace219530ddd83f5f3f54d5b329b94a3d" title="Write a 16-bit unsigned value to EtherCAT data.">EC_WRITE_U16</a>(datagram-&gt;<a class="code" href="structec__datagram__t.html#acbe5cfc2b01e0ec6cb720b3dc99c4027" title="Recipient address.">address</a> + 2, mem_address);
<a name="l00424"></a>00424     EC_FUNC_FOOTER;
<a name="l00425"></a>00425 }
<a name="l00426"></a>00426 
<a name="l00427"></a>00427 <span class="comment">/*****************************************************************************/</span>
<a name="l00428"></a>00428 
<a name="l00433"></a><a class="code" href="datagram_8h.html#aabc448d4b7b6ec688240c20bbf81db08">00433</a> <span class="keywordtype">int</span> <a class="code" href="datagram_8c.html#ab55ab76a42b6153c3bb98f513b4f9450" title="Initializes an EtherCAT LRD datagram.">ec_datagram_lrd</a>(
<a name="l00434"></a>00434         <a class="code" href="structec__datagram__t.html" title="EtherCAT datagram.">ec_datagram_t</a> *datagram, 
<a name="l00435"></a>00435         uint32_t offset, 
<a name="l00436"></a>00436         <span class="keywordtype">size_t</span> data_size 
<a name="l00437"></a>00437         )
<a name="l00438"></a>00438 {
<a name="l00439"></a>00439     <span class="keywordtype">int</span> ret;
<a name="l00440"></a>00440     EC_FUNC_HEADER;
<a name="l00441"></a>00441     datagram-&gt;<a class="code" href="structec__datagram__t.html#a5c19753e2f2a239f3496cde3f9c1ee53" title="Datagram type (APRD, BWR, etc.).">type</a> = <a class="code" href="datagram_8h.html#a03209bc3f89797943506f8f7c160b015ae39583a474563f9420fee3bdcac8f738" title="Logical Read.">EC_DATAGRAM_LRD</a>;
<a name="l00442"></a>00442     <a class="code" href="group__ApplicationInterface.html#ga9558cb79cc4015da0a551704649d1e80" title="Write a 32-bit unsigned value to EtherCAT data.">EC_WRITE_U32</a>(datagram-&gt;<a class="code" href="structec__datagram__t.html#acbe5cfc2b01e0ec6cb720b3dc99c4027" title="Recipient address.">address</a>, offset);
<a name="l00443"></a>00443     EC_FUNC_FOOTER;
<a name="l00444"></a>00444 }
<a name="l00445"></a>00445 
<a name="l00446"></a>00446 <span class="comment">/*****************************************************************************/</span>
<a name="l00447"></a>00447 
<a name="l00452"></a><a class="code" href="datagram_8h.html#ae86a6739ed9060237d935adb4240e1a7">00452</a> <span class="keywordtype">int</span> <a class="code" href="datagram_8c.html#aadace5dd3018b8cbcd8f3905a086ea9d" title="Initializes an EtherCAT LWR datagram.">ec_datagram_lwr</a>(
<a name="l00453"></a>00453         <a class="code" href="structec__datagram__t.html" title="EtherCAT datagram.">ec_datagram_t</a> *datagram, 
<a name="l00454"></a>00454         uint32_t offset, 
<a name="l00455"></a>00455         <span class="keywordtype">size_t</span> data_size 
<a name="l00456"></a>00456         )
<a name="l00457"></a>00457 {
<a name="l00458"></a>00458     <span class="keywordtype">int</span> ret;
<a name="l00459"></a>00459     EC_FUNC_HEADER;
<a name="l00460"></a>00460     datagram-&gt;<a class="code" href="structec__datagram__t.html#a5c19753e2f2a239f3496cde3f9c1ee53" title="Datagram type (APRD, BWR, etc.).">type</a> = <a class="code" href="datagram_8h.html#a03209bc3f89797943506f8f7c160b015a8821b71eda807ab031ecf7e3030ebe1f" title="Logical Write.">EC_DATAGRAM_LWR</a>;
<a name="l00461"></a>00461     <a class="code" href="group__ApplicationInterface.html#ga9558cb79cc4015da0a551704649d1e80" title="Write a 32-bit unsigned value to EtherCAT data.">EC_WRITE_U32</a>(datagram-&gt;<a class="code" href="structec__datagram__t.html#acbe5cfc2b01e0ec6cb720b3dc99c4027" title="Recipient address.">address</a>, offset);
<a name="l00462"></a>00462     EC_FUNC_FOOTER;
<a name="l00463"></a>00463 }
<a name="l00464"></a>00464 
<a name="l00465"></a>00465 <span class="comment">/*****************************************************************************/</span>
<a name="l00466"></a>00466 
<a name="l00471"></a><a class="code" href="datagram_8h.html#aecf0cddb70deea7a91ff65037faa8f29">00471</a> <span class="keywordtype">int</span> <a class="code" href="datagram_8c.html#ae8724f060b07cdbed10a0e264d066094" title="Initializes an EtherCAT LRW datagram.">ec_datagram_lrw</a>(
<a name="l00472"></a>00472         <a class="code" href="structec__datagram__t.html" title="EtherCAT datagram.">ec_datagram_t</a> *datagram, 
<a name="l00473"></a>00473         uint32_t offset, 
<a name="l00474"></a>00474         <span class="keywordtype">size_t</span> data_size 
<a name="l00475"></a>00475         )
<a name="l00476"></a>00476 {
<a name="l00477"></a>00477     <span class="keywordtype">int</span> ret;
<a name="l00478"></a>00478     EC_FUNC_HEADER;
<a name="l00479"></a>00479     datagram-&gt;<a class="code" href="structec__datagram__t.html#a5c19753e2f2a239f3496cde3f9c1ee53" title="Datagram type (APRD, BWR, etc.).">type</a> = <a class="code" href="datagram_8h.html#a03209bc3f89797943506f8f7c160b015a7b305ba36800dd3e5c61203cdd6a5093" title="Logical ReadWrite.">EC_DATAGRAM_LRW</a>;
<a name="l00480"></a>00480     <a class="code" href="group__ApplicationInterface.html#ga9558cb79cc4015da0a551704649d1e80" title="Write a 32-bit unsigned value to EtherCAT data.">EC_WRITE_U32</a>(datagram-&gt;<a class="code" href="structec__datagram__t.html#acbe5cfc2b01e0ec6cb720b3dc99c4027" title="Recipient address.">address</a>, offset);
<a name="l00481"></a>00481     EC_FUNC_FOOTER;
<a name="l00482"></a>00482 }
<a name="l00483"></a>00483 
<a name="l00484"></a>00484 <span class="comment">/*****************************************************************************/</span>
<a name="l00485"></a>00485 
<a name="l00493"></a><a class="code" href="datagram_8h.html#a9c8a833002784ce7c8855b11afd5bd87">00493</a> <span class="keywordtype">int</span> <a class="code" href="datagram_8c.html#a5469e87537d8c03970d1981984cf4b38" title="Initializes an EtherCAT LRD datagram with external memory.">ec_datagram_lrd_ext</a>(
<a name="l00494"></a>00494         <a class="code" href="structec__datagram__t.html" title="EtherCAT datagram.">ec_datagram_t</a> *datagram, 
<a name="l00495"></a>00495         uint32_t offset, 
<a name="l00496"></a>00496         <span class="keywordtype">size_t</span> data_size, 
<a name="l00497"></a>00497         uint8_t *external_memory 
<a name="l00498"></a>00498         )
<a name="l00499"></a>00499 {
<a name="l00500"></a>00500     <span class="keywordtype">int</span> ret;
<a name="l00501"></a>00501     datagram-&gt;<a class="code" href="structec__datagram__t.html#ae7471d08444f2bc780532e9268859296" title="Datagram payload.">data</a> = external_memory;
<a name="l00502"></a>00502     datagram-&gt;<a class="code" href="structec__datagram__t.html#ae8d52c6dc3ef92d165d9d14cd9c3d593" title="Origin of the data memory.">data_origin</a> = <a class="code" href="globals_8h.html#ab62b6e667f97a3b63d18f8077487d249a9f7450cec35e7aba63f3de7520f41c4a" title="External.">EC_ORIG_EXTERNAL</a>;
<a name="l00503"></a>00503     EC_FUNC_HEADER;
<a name="l00504"></a>00504     datagram-&gt;<a class="code" href="structec__datagram__t.html#a5c19753e2f2a239f3496cde3f9c1ee53" title="Datagram type (APRD, BWR, etc.).">type</a> = <a class="code" href="datagram_8h.html#a03209bc3f89797943506f8f7c160b015ae39583a474563f9420fee3bdcac8f738" title="Logical Read.">EC_DATAGRAM_LRD</a>;
<a name="l00505"></a>00505     <a class="code" href="group__ApplicationInterface.html#ga9558cb79cc4015da0a551704649d1e80" title="Write a 32-bit unsigned value to EtherCAT data.">EC_WRITE_U32</a>(datagram-&gt;<a class="code" href="structec__datagram__t.html#acbe5cfc2b01e0ec6cb720b3dc99c4027" title="Recipient address.">address</a>, offset);
<a name="l00506"></a>00506     EC_FUNC_FOOTER;
<a name="l00507"></a>00507 }
<a name="l00508"></a>00508 
<a name="l00509"></a>00509 <span class="comment">/*****************************************************************************/</span>
<a name="l00510"></a>00510 
<a name="l00518"></a><a class="code" href="datagram_8h.html#a40de84b0b6fa9336d4713a06da68dfdc">00518</a> <span class="keywordtype">int</span> <a class="code" href="datagram_8c.html#a5ccd1a04e0901c0bc716b4d7f3dd676d" title="Initializes an EtherCAT LWR datagram with external memory.">ec_datagram_lwr_ext</a>(
<a name="l00519"></a>00519         <a class="code" href="structec__datagram__t.html" title="EtherCAT datagram.">ec_datagram_t</a> *datagram, 
<a name="l00520"></a>00520         uint32_t offset, 
<a name="l00521"></a>00521         <span class="keywordtype">size_t</span> data_size, 
<a name="l00522"></a>00522         uint8_t *external_memory 
<a name="l00523"></a>00523         )
<a name="l00524"></a>00524 {
<a name="l00525"></a>00525     <span class="keywordtype">int</span> ret;
<a name="l00526"></a>00526     datagram-&gt;<a class="code" href="structec__datagram__t.html#ae7471d08444f2bc780532e9268859296" title="Datagram payload.">data</a> = external_memory;
<a name="l00527"></a>00527     datagram-&gt;<a class="code" href="structec__datagram__t.html#ae8d52c6dc3ef92d165d9d14cd9c3d593" title="Origin of the data memory.">data_origin</a> = <a class="code" href="globals_8h.html#ab62b6e667f97a3b63d18f8077487d249a9f7450cec35e7aba63f3de7520f41c4a" title="External.">EC_ORIG_EXTERNAL</a>;
<a name="l00528"></a>00528     EC_FUNC_HEADER;
<a name="l00529"></a>00529     datagram-&gt;<a class="code" href="structec__datagram__t.html#a5c19753e2f2a239f3496cde3f9c1ee53" title="Datagram type (APRD, BWR, etc.).">type</a> = <a class="code" href="datagram_8h.html#a03209bc3f89797943506f8f7c160b015a8821b71eda807ab031ecf7e3030ebe1f" title="Logical Write.">EC_DATAGRAM_LWR</a>;
<a name="l00530"></a>00530     <a class="code" href="group__ApplicationInterface.html#ga9558cb79cc4015da0a551704649d1e80" title="Write a 32-bit unsigned value to EtherCAT data.">EC_WRITE_U32</a>(datagram-&gt;<a class="code" href="structec__datagram__t.html#acbe5cfc2b01e0ec6cb720b3dc99c4027" title="Recipient address.">address</a>, offset);
<a name="l00531"></a>00531     EC_FUNC_FOOTER;
<a name="l00532"></a>00532 }
<a name="l00533"></a>00533 
<a name="l00534"></a>00534 <span class="comment">/*****************************************************************************/</span>
<a name="l00535"></a>00535 
<a name="l00543"></a><a class="code" href="datagram_8h.html#aec1a712ab2eb262b2100180787b30648">00543</a> <span class="keywordtype">int</span> <a class="code" href="datagram_8c.html#a28e3b0846186d09fbb8c4166c4a6eaba" title="Initializes an EtherCAT LRW datagram with external memory.">ec_datagram_lrw_ext</a>(
<a name="l00544"></a>00544         <a class="code" href="structec__datagram__t.html" title="EtherCAT datagram.">ec_datagram_t</a> *datagram, 
<a name="l00545"></a>00545         uint32_t offset, 
<a name="l00546"></a>00546         <span class="keywordtype">size_t</span> data_size, 
<a name="l00547"></a>00547         uint8_t *external_memory 
<a name="l00548"></a>00548         )
<a name="l00549"></a>00549 {
<a name="l00550"></a>00550     <span class="keywordtype">int</span> ret;
<a name="l00551"></a>00551     datagram-&gt;<a class="code" href="structec__datagram__t.html#ae7471d08444f2bc780532e9268859296" title="Datagram payload.">data</a> = external_memory;
<a name="l00552"></a>00552     datagram-&gt;<a class="code" href="structec__datagram__t.html#ae8d52c6dc3ef92d165d9d14cd9c3d593" title="Origin of the data memory.">data_origin</a> = <a class="code" href="globals_8h.html#ab62b6e667f97a3b63d18f8077487d249a9f7450cec35e7aba63f3de7520f41c4a" title="External.">EC_ORIG_EXTERNAL</a>;
<a name="l00553"></a>00553     EC_FUNC_HEADER;
<a name="l00554"></a>00554     datagram-&gt;<a class="code" href="structec__datagram__t.html#a5c19753e2f2a239f3496cde3f9c1ee53" title="Datagram type (APRD, BWR, etc.).">type</a> = <a class="code" href="datagram_8h.html#a03209bc3f89797943506f8f7c160b015a7b305ba36800dd3e5c61203cdd6a5093" title="Logical ReadWrite.">EC_DATAGRAM_LRW</a>;
<a name="l00555"></a>00555     <a class="code" href="group__ApplicationInterface.html#ga9558cb79cc4015da0a551704649d1e80" title="Write a 32-bit unsigned value to EtherCAT data.">EC_WRITE_U32</a>(datagram-&gt;<a class="code" href="structec__datagram__t.html#acbe5cfc2b01e0ec6cb720b3dc99c4027" title="Recipient address.">address</a>, offset);
<a name="l00556"></a>00556     EC_FUNC_FOOTER;
<a name="l00557"></a>00557 }
<a name="l00558"></a>00558 
<a name="l00559"></a>00559 <span class="comment">/*****************************************************************************/</span>
<a name="l00560"></a>00560 
<a name="l00565"></a><a class="code" href="datagram_8h.html#ace816d0d8117ee2d89185bcae16d45e4">00565</a> <span class="keywordtype">void</span> <a class="code" href="datagram_8c.html#a84b0c2679038e17cfd5af69df9a68001" title="Prints the state of a datagram.">ec_datagram_print_state</a>(
<a name="l00566"></a>00566         <span class="keyword">const</span> <a class="code" href="structec__datagram__t.html" title="EtherCAT datagram.">ec_datagram_t</a> *datagram 
<a name="l00567"></a>00567         )
<a name="l00568"></a>00568 {
<a name="l00569"></a>00569     printk(<span class="stringliteral">&quot;Datagram &quot;</span>);
<a name="l00570"></a>00570     <span class="keywordflow">switch</span> (datagram-&gt;<a class="code" href="structec__datagram__t.html#a90d55e568be4b8464e9725c105d6c4b0" title="State.">state</a>) {
<a name="l00571"></a>00571         <span class="keywordflow">case</span> <a class="code" href="datagram_8h.html#ac9882419ec1404dcca75761c4d1ce720a5ccc352710bfd57969fdba9a13f91f71" title="Initial state of a new datagram.">EC_DATAGRAM_INIT</a>:
<a name="l00572"></a>00572             printk(<span class="stringliteral">&quot;initialized&quot;</span>);
<a name="l00573"></a>00573             <span class="keywordflow">break</span>;
<a name="l00574"></a>00574         <span class="keywordflow">case</span> <a class="code" href="datagram_8h.html#ac9882419ec1404dcca75761c4d1ce720acb7d25358159e7c95e334a74b97d661c" title="Queued for sending.">EC_DATAGRAM_QUEUED</a>:
<a name="l00575"></a>00575             printk(<span class="stringliteral">&quot;queued&quot;</span>);
<a name="l00576"></a>00576             <span class="keywordflow">break</span>;
<a name="l00577"></a>00577         <span class="keywordflow">case</span> <a class="code" href="datagram_8h.html#ac9882419ec1404dcca75761c4d1ce720abe88d98e46c97099702211a92e1d8c9d" title="Sent (still in the queue).">EC_DATAGRAM_SENT</a>:
<a name="l00578"></a>00578             printk(<span class="stringliteral">&quot;sent&quot;</span>);
<a name="l00579"></a>00579             <span class="keywordflow">break</span>;
<a name="l00580"></a>00580         <span class="keywordflow">case</span> <a class="code" href="datagram_8h.html#ac9882419ec1404dcca75761c4d1ce720a95630d1e98f6217bf0392b4295c5bc6a" title="Received (dequeued).">EC_DATAGRAM_RECEIVED</a>:
<a name="l00581"></a>00581             printk(<span class="stringliteral">&quot;received&quot;</span>);
<a name="l00582"></a>00582             <span class="keywordflow">break</span>;
<a name="l00583"></a>00583         <span class="keywordflow">case</span> <a class="code" href="datagram_8h.html#ac9882419ec1404dcca75761c4d1ce720a9f9009188c7cee7d421908a8924ba5e8" title="Timed out (dequeued).">EC_DATAGRAM_TIMED_OUT</a>:
<a name="l00584"></a>00584             printk(<span class="stringliteral">&quot;timed out&quot;</span>);
<a name="l00585"></a>00585             <span class="keywordflow">break</span>;
<a name="l00586"></a>00586         <span class="keywordflow">case</span> <a class="code" href="datagram_8h.html#ac9882419ec1404dcca75761c4d1ce720af9a4a9cb27dca2c36d87f734fa36debf" title="Error while sending/receiving (dequeued).">EC_DATAGRAM_ERROR</a>:
<a name="l00587"></a>00587             printk(<span class="stringliteral">&quot;error&quot;</span>);
<a name="l00588"></a>00588             <span class="keywordflow">break</span>;
<a name="l00589"></a>00589         <span class="keywordflow">default</span>:
<a name="l00590"></a>00590             printk(<span class="stringliteral">&quot;???&quot;</span>);
<a name="l00591"></a>00591     }
<a name="l00592"></a>00592 
<a name="l00593"></a>00593     printk(<span class="stringliteral">&quot;.\n&quot;</span>);
<a name="l00594"></a>00594 }
<a name="l00595"></a>00595 
<a name="l00596"></a>00596 <span class="comment">/*****************************************************************************/</span>
<a name="l00597"></a>00597 
<a name="l00602"></a><a class="code" href="datagram_8h.html#a447b859841b687ecbe7bbf5ee896bc11">00602</a> <span class="keywordtype">void</span> <a class="code" href="datagram_8c.html#a1f7361d097a385f3ed98ce98ba352a1c" title="Evaluates the working counter of a single-cast datagram.">ec_datagram_print_wc_error</a>(
<a name="l00603"></a>00603         <span class="keyword">const</span> <a class="code" href="structec__datagram__t.html" title="EtherCAT datagram.">ec_datagram_t</a> *datagram 
<a name="l00604"></a>00604         )
<a name="l00605"></a>00605 {
<a name="l00606"></a>00606     <span class="keywordflow">if</span> (datagram-&gt;<a class="code" href="structec__datagram__t.html#a1eeebb1d33d0dbf47498dd78a966977d" title="Working counter.">working_counter</a> == 0)
<a name="l00607"></a>00607         printk(<span class="stringliteral">&quot;No response.&quot;</span>);
<a name="l00608"></a>00608     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (datagram-&gt;<a class="code" href="structec__datagram__t.html#a1eeebb1d33d0dbf47498dd78a966977d" title="Working counter.">working_counter</a> &gt; 1)
<a name="l00609"></a>00609         printk(<span class="stringliteral">&quot;%u slaves responded!&quot;</span>, datagram-&gt;<a class="code" href="structec__datagram__t.html#a1eeebb1d33d0dbf47498dd78a966977d" title="Working counter.">working_counter</a>);
<a name="l00610"></a>00610     <span class="keywordflow">else</span>
<a name="l00611"></a>00611         printk(<span class="stringliteral">&quot;Success.&quot;</span>);
<a name="l00612"></a>00612     printk(<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00613"></a>00613 }
<a name="l00614"></a>00614 
<a name="l00615"></a>00615 <span class="comment">/*****************************************************************************/</span>
<a name="l00616"></a>00616 
<a name="l00619"></a><a class="code" href="datagram_8h.html#a8802eeb907490d0f927538d95aaf805e">00619</a> <span class="keywordtype">void</span> <a class="code" href="datagram_8c.html#a89bbb5e33d0b78760734a3984e4e394f" title="Outputs datagram statistics at most every second.">ec_datagram_output_stats</a>(
<a name="l00620"></a>00620         <a class="code" href="structec__datagram__t.html" title="EtherCAT datagram.">ec_datagram_t</a> *datagram
<a name="l00621"></a>00621         )
<a name="l00622"></a>00622 {
<a name="l00623"></a>00623     <span class="keywordflow">if</span> (jiffies - datagram-&gt;<a class="code" href="structec__datagram__t.html#a9a6c9216d340b19a47e802ce89fbb269" title="Last statistics output.">stats_output_jiffies</a> &gt; HZ) {
<a name="l00624"></a>00624         datagram-&gt;<a class="code" href="structec__datagram__t.html#a9a6c9216d340b19a47e802ce89fbb269" title="Last statistics output.">stats_output_jiffies</a> = jiffies;
<a name="l00625"></a>00625 
<a name="l00626"></a>00626         <span class="keywordflow">if</span> (unlikely(datagram-&gt;<a class="code" href="structec__datagram__t.html#af7007d254b40111c064caaac6f9c4f81" title="Number of requeues when not yet received.">skip_count</a>)) {
<a name="l00627"></a>00627             <a class="code" href="globals_8h.html#a268d5c7947aba061aee9ba26ae5e54cf" title="Convenience macro for printing EtherCAT-specific warnings to syslog.">EC_WARN</a>(<span class="stringliteral">&quot;Datagram %p (%s) was SKIPPED %u time%s.\n&quot;</span>,
<a name="l00628"></a>00628                     datagram, datagram-&gt;<a class="code" href="structec__datagram__t.html#af2690854e7fb1c410aa37a1ed225836d" title="Description of the datagram.">name</a>,
<a name="l00629"></a>00629                     datagram-&gt;<a class="code" href="structec__datagram__t.html#af7007d254b40111c064caaac6f9c4f81" title="Number of requeues when not yet received.">skip_count</a>,
<a name="l00630"></a>00630                     datagram-&gt;<a class="code" href="structec__datagram__t.html#af7007d254b40111c064caaac6f9c4f81" title="Number of requeues when not yet received.">skip_count</a> == 1 ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;s&quot;</span>);
<a name="l00631"></a>00631             datagram-&gt;<a class="code" href="structec__datagram__t.html#af7007d254b40111c064caaac6f9c4f81" title="Number of requeues when not yet received.">skip_count</a> = 0;
<a name="l00632"></a>00632         }
<a name="l00633"></a>00633     }
<a name="l00634"></a>00634 }
<a name="l00635"></a>00635 
<a name="l00636"></a>00636 <span class="comment">/*****************************************************************************/</span>
<a name="l00637"></a>00637 
<a name="l00642"></a><a class="code" href="datagram_8h.html#a9534d758b8408b2c7d5b64dcfbc0cd10">00642</a> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="datagram_8c.html#a557d736d87dd0e69dd29ee75de817dc8" title="Returns a string describing the datagram type.">ec_datagram_type_string</a>(
<a name="l00643"></a>00643         <span class="keyword">const</span> <a class="code" href="structec__datagram__t.html" title="EtherCAT datagram.">ec_datagram_t</a> *datagram 
<a name="l00644"></a>00644         )
<a name="l00645"></a>00645 {
<a name="l00646"></a>00646     <span class="keywordflow">return</span> <a class="code" href="datagram_8c.html#a7e261a85cb515f83efd0be78ca331414" title="Array of datagram type strings used in ec_datagram_type_string().">type_strings</a>[datagram-&gt;<a class="code" href="structec__datagram__t.html#a5c19753e2f2a239f3496cde3f9c1ee53" title="Datagram type (APRD, BWR, etc.).">type</a>];
<a name="l00647"></a>00647 }
<a name="l00648"></a>00648 
<a name="l00649"></a>00649 <span class="comment">/*****************************************************************************/</span>
</pre></div></div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="datagram_8c.html">datagram.c</a>      </li>

    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
