cmake_minimum_required (VERSION 2.8)
project (BookingCommon)

SET (CMAKE_CXX_FLAGS "-g -Wall")

# TinyXml is required. Since there was an API change at 2.6 we need to check
# the version number and define a flag accordingly
include(FindPkgConfig)
pkg_check_modules(TINYXML REQUIRED tinyxml)
pkg_check_modules(TINYXML26 tinyxml>=2.6)
if( NOT TINYXML26_FOUND )
    SET (CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -DTINYXML_API_PRE26")
    MESSAGE("Using old tinyxml API (pre 2.6). Setting the compilation flag TINYXML_API_PRE26.")
endif( NOT TINYXML26_FOUND )


INCLUDE_DIRECTORIES (src)

SET (LIB_SRCS src/Station.cpp src/StationDoesNotExist.cpp src/StationList.cpp src/StationPath.cpp src/Threaded.cpp src/RoutePlanner.cpp src/MissionComm.cpp src/HTTPClient.cpp src/DBInterface.cpp src/SvgPath.cpp)

ADD_LIBRARY (bookingcommon SHARED ${LIB_SRCS})
ADD_LIBRARY(bookingcommon-static STATIC ${LIB_SRCS})
SET_TARGET_PROPERTIES(bookingcommon-static PROPERTIES OUTPUT_NAME "bookingcommon")
SET_TARGET_PROPERTIES(bookingcommon-static PROPERTIES PREFIX "lib")

# Help CMake 2.6.x and lower (not necessary for 2.8 and above, but doesn't hurt):
SET_TARGET_PROPERTIES(bookingcommon PROPERTIES CLEAN_DIRECT_OUTPUT 1)
SET_TARGET_PROPERTIES(bookingcommon-static PROPERTIES CLEAN_DIRECT_OUTPUT 1)
